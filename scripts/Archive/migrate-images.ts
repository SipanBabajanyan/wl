import { updateImagePaths } from './update-image-paths'
import { cleanupOldImages } from './cleanup-old-images'

/**
 * –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å JPEG –Ω–∞ PNG
 * –í—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–º–µ–Ω—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:
 * 1. –û–±–Ω–æ–≤–ª—è–µ—Ç –ø—É—Ç–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
 * 2. –£–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ JPEG —Ñ–∞–π–ª—ã
 */

async function migrateImages() {
  try {
    console.log('üöÄ –ù–∞—á–∏–Ω–∞–µ–º –º–∏–≥—Ä–∞—Ü–∏—é –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å JPEG –Ω–∞ PNG...')
    console.log('=' .repeat(60))
    
    // –®–∞–≥ 1: –û–±–Ω–æ–≤–ª—è–µ–º –ø—É—Ç–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    console.log('\nüìù –®–ê–ì 1: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—É—Ç–µ–π –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö')
    console.log('-'.repeat(40))
    await updateImagePaths()
    
    // –®–∞–≥ 2: –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ JPEG —Ñ–∞–π–ª—ã
    console.log('\nüßπ –®–ê–ì 2: –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö JPEG —Ñ–∞–π–ª–æ–≤')
    console.log('-'.repeat(40))
    await cleanupOldImages()
    
    console.log('\n' + '='.repeat(60))
    console.log('üéâ –ú–ò–ì–†–ê–¶–ò–Ø –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô –ó–ê–í–ï–†–®–ï–ù–ê –£–°–ü–ï–®–ù–û!')
    console.log('=' .repeat(60))
    
    console.log('\nüìã –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ:')
    console.log('  ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã –ø—É—Ç–∏ –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö')
    console.log('  ‚úÖ –£–¥–∞–ª–µ–Ω—ã —Å—Ç–∞—Ä—ã–µ JPEG —Ñ–∞–π–ª—ã')
    console.log('  ‚úÖ –í—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç PNG –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è')
    
    console.log('\nüí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:')
    console.log('  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É —Å–∞–π—Ç–∞')
    console.log('  - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ')
    console.log('  - –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–¥–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö')

  } catch (error) {
    console.error('\n‚ùå –û–®–ò–ë–ö–ê –ü–†–ò –ú–ò–ì–†–ê–¶–ò–ò –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô:', error)
    console.log('\nüîß –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:')
    console.log('  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö')
    console.log('  - –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ PNG —Ñ–∞–π–ª—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç')
    console.log('  - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º')
    throw error
  }
}

// –ó–∞–ø—É—Å–∫–∞–µ–º –º–∏–≥—Ä–∞—Ü–∏—é
if (require.main === module) {
  migrateImages()
    .then(() => {
      console.log('\n‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ')
      process.exit(0)
    })
    .catch((error) => {
      console.error('\n‚ùå –û—à–∏–±–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏:', error)
      process.exit(1)
    })
}

export { migrateImages }
